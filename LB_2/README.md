# Лабораторная работа #2

Отчеты в формате parquet хранятся в папке output

## 1) Для начала загрузим данные

1.1) Чтение о постах Stack Overflow

![1](https://github.com/vasser2323/BigData/assets/73202398/58b54ea5-7437-49cf-9539-f08f6510e043)

## 2) Работа с данными

### 2.1) Выбор необходимых столбцов

2.1.1) Функция get_tags - принимает строку "tags_string" и ищет в ней
подстроки, соответствующие определенному шаблону.

2.1.2) Функция "get_year" - принимает объект даты и времени и возвращаетт только год из этой даты.

2.1.3) Применение функций к столбцам 

2.1.4) Выбор необходимых столбцов и отображения их 

![2](https://github.com/vasser2323/BigData/assets/73202398/cd4338ab-de3d-4500-97dd-e148fbce7edf)

![3](https://github.com/vasser2323/BigData/assets/73202398/60cbcd51-7681-4639-bd5e-e100f1ffd491)

2.1.5) Полученные данные: 

![4](https://github.com/vasser2323/BigData/assets/73202398/0c9bba64-a106-42ff-817e-0e43b481e537)

### 2.2) Удаление тегов, не соответсвующих языкам программирования 

2.2.1) Преобразование названий языков программирования в  нижний регистр 

2.2.2) Разделения массива егов на отдельные строки

2.2.3) Присоединение таблицы языков программирования для фильтрации постов по языку

2.2.4) Выбор необходимых столбцов и отображение их

![5](https://github.com/vasser2323/BigData/assets/73202398/c239dd73-4a16-410d-9ba2-f70456743151)

2.2.5) Полученные столбцы: 

![6](https://github.com/vasser2323/BigData/assets/73202398/b9023ce3-bf9b-458d-adf7-bfd93dedd934)

## 3) Подготовка к  отчету

3.1) Группировка по году, тегам с суммированием просмотров

3.2) Сортировка по году и количеству просмотров

![7](https://github.com/vasser2323/BigData/assets/73202398/60839ad9-9c68-415a-8392-0b8cd6b3359f)

3.3) Вывод результатов

![8](https://github.com/vasser2323/BigData/assets/73202398/810fdcd1-859c-4382-87a4-85c4e04ead39)

## 4) Итоговый отчет

4.1) Группировка и суммирование просмотров по году и тегам

4.2) Сортировка по году и общему количеству просмотров

4.3) Разбиение по годам и сохранение в отдельные файлы

4.4) Перебор по годам для сохранения данных в отдельные файлы

4.5) Определение пути для сохранения данных по текущему году

4.6) Разбиение по году и сохранение в формате "Parquet"

![9](https://github.com/vasser2323/BigData/assets/73202398/187c7f2b-7ea0-464e-a78c-90d0f4050451)



